
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL") // Correct, utilisera la valeur de votre .env
}

model User {
  id        Int      @id @default(autoincrement())
  email     String   @unique
  passwordHash String // Vous en aurez besoin pour une vraie authentification
  name      String?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  profileImageUrl String?
  balance         Decimal   @default(1000.00)
  createdAt       DateTime  @default(now())
  updatedAt       DateTime  @updatedAt

  gameHistory     GameHistory[]
}

model GameHistory {
  id                  String    @id @default(cuid())
  userId              String
  playedAt            DateTime  @default(now())

  betAmount           Decimal
  outcome             GameOutcome
  payoutAmount        Decimal

  initialPlayerHand   String
  initialDealerUpCard String
  finalPlayerHand     String
  finalDealerHand     String


  playerScore         Int
  dealerScore         Int

  user                User      @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([playedAt])
}

enum GameOutcome {
  PLAYER_WIN
  DEALER_WIN
  PUSH
  PLAYER_BLACKJACK
  PLAYER_BUST
  DEALER_BUST
}